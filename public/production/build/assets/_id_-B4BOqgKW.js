import{K as I,m as O,r as g,j as e,L as $,$ as c,S as C}from"./app-BO2Erc1k.js";import{A as L,D as B,a as K,b as z,c as D}from"./app-layout-DWGmey9C.js";import{u as F,a as A,D as G,c as H,S as Q,v as R,s as U,K as _,P as q,b as W,C as J}from"./sortable.esm-CFWCLgN2.js";import{E as V}from"./edit-course-modal-BJTDuZ9w.js";import{B as i}from"./button-Bo_LbEuX.js";import{A as X}from"./admin-users-table-B8bgWGZi.js";import{C as Y}from"./createQuiz-t77P1ouR.js";import{C as Z,a as ee,d as se}from"./card-BcU8RAaX.js";import{E as re,A as te,a as ie,b as oe,c as ae,d as ne,e as le,f as de,g as ce}from"./alert-dialog-BdoB9muQ.js";import{T as me}from"./TruncateText-QlkhsmfY.js";import{A as he}from"./arrow-left-B6HBT3vM.js";import{S as y}from"./square-pen-D_LVuXZi.js";import{P as S}from"./plus-bcunI6PJ.js";import{E as pe}from"./eye-BQ_Zxsbs.js";import{T as xe}from"./trash-2-C8cCXFAJ.js";import"./index-Dl5nQ3KP.js";import"./index-DdbgeCqb.js";import"./index-DXSOa7z7.js";import"./index-B1FhypQQ.js";import"./book-open-B6vd86xF.js";import"./dialog-I1RqCxJl.js";import"./input-COSAMtAb.js";import"./label-Bqb7aRek.js";import"./tabs-7DVaec6h.js";import"./textarea-BwgXVmor.js";import"./image-CLyO7MNW.js";import"./table-B99VxqgY.js";import"./badge-sg1cCvKz.js";import"./select-DfsXUpRv.js";import"./index-BdQq_4o_.js";import"./chevron-down-TiK4eFmA.js";import"./check-BftTAXPi.js";import"./search-DifM3Dnv.js";import"./filter-B7KaGF9X.js";import"./radio-group-B0hPLyc1.js";import"./checkbox-D6cfYiD-.js";import"./save--O3mJBTg.js";import"./copy-Df-CLvWp.js";function ue({chapter:s,onTogglePublish:v,onEdit:w,idx:m,onDelete:h}){const{attributes:b,listeners:o,setNodeRef:a,transform:p,transition:l}=W({id:s.id}),x={transform:J.Transform.toString(p),transition:l},[u,d]=g.useState(!1);return e.jsxs("div",{ref:a,style:x,className:"flex items-center border-b p-4 last:border-b-0",children:[e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("div",{className:"flex items-center gap-x-6",children:[e.jsx("div",{className:"bg-primary/10 text-primary flex p-2",children:m+1}),e.jsxs("div",{children:[e.jsxs("h3",{onClick:()=>C.visit(`/admin/chapter/${s.id}/edit`),className:"cursor-pointer font-medium w-5/6",children:["  ",s.title.en]}),e.jsx("p",{className:"text-muted-foreground truncate text-sm",children:e.jsx(me,{text:s.description.en,length:40})})]})]})}),e.jsx("div",{className:"ml-4 flex items-center gap-4",children:e.jsxs(B,{children:[e.jsx(K,{asChild:!0,children:e.jsxs(i,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(z,{align:"end",children:[e.jsxs(D,{onClick:()=>C.visit(`/admin/chapter/${s.id}/edit`),children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(D,{className:"text-destructive focus:text-destructive",onClick:()=>d(!0),children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}),e.jsx(te,{open:u,onOpenChange:d,children:e.jsxs(ie,{children:[e.jsxs(oe,{children:[e.jsx(ae,{children:"Are you sure you want to delete this chapter?"}),e.jsx(ne,{children:"This action cannot be undone. This will permanently delete the chapter and all its content."})]}),e.jsxs(le,{children:[e.jsx(de,{children:"Cancel"}),e.jsx(ce,{onClick:()=>h(s.id),className:"bg-destructive text-white hover:bg-destructive/90",children:"Delete"})]})]})})]})}const es=()=>{const{course:s,modules:v,courseQuiz:w}=I().props,{delete:m}=O(),h=r=>{m(route("chapter.destroy",r),{onFinish:()=>a(o.filter(t=>t.id!==r))})},b=[{title:"course - "+s.name.en}],[o,a]=g.useState(v),[p,l]=g.useState(!1),x=F(A(q),A(_,{coordinateGetter:U})),u=r=>{a(o.map(t=>t.id===r?{...t,published:!t.published}:t))},d=r=>{const{active:t,over:N}=r;t.id!==N.id&&a(j=>{const T=j.findIndex(n=>n.id===t.id),P=j.findIndex(n=>n.id===N.id),f=[...j],[k]=f.splice(T,1);return f.splice(P,0,k),f.map((n,M)=>({...n,position:M+1}))})},E=r=>{C.push(`/dashboard/courses/jhg/chapters/${r.id}`)};return e.jsxs(L,{breadcrumbs:b,children:[e.jsx($,{title:"Courses"}),e.jsxs("div",{className:"space-y-6 p-3 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:"outline",asChild:!0,children:e.jsxs(c,{href:"/admin/courses",children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs(i,{variant:"outline",onClick:()=>l(!0),children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Edit Course"]}),e.jsx(i,{variant:"outline",asChild:!0,children:e.jsxs(c,{href:"/dashboard/courses/jhg/workshops/new",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Create Workshop"]})}),e.jsx(i,{variant:"outline",asChild:!0,children:e.jsxs(c,{href:`preview/${s.id}`,target:"_blank",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Preview"]})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(Z,{className:"h-[70vh] overflow-x-hidden overflow-y-auto",children:[e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Course Chapters"}),e.jsx(i,{asChild:!0,children:e.jsxs(c,{href:"/admin/chapter/create?course="+s.id,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Add Chapter"]})})]})}),e.jsx(se,{className:"px-3",children:e.jsx(G,{sensors:x,collisionDetection:H,onDragEnd:d,children:e.jsx(Q,{items:o.map(r=>r.id),strategy:R,children:o.map((r,t)=>e.jsx("div",{children:e.jsx(ue,{chapter:r,onTogglePublish:u,onEdit:E,idx:t,onDelete:h},r.id)},t))})})})]}),e.jsx(X,{role:!0,showAddButton:!1,title:"Enrolled users",description:"Manage NGOs enrolled in this course",Users:s.users})]}),e.jsx("div",{className:"",children:e.jsx(Y,{course_id:s.id,courseQuiz:w})})]}),e.jsx(V,{course:s,open:p,onOpenChange:l})]})};export{es as default};
