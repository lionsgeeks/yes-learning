import{m as re,j as e}from"./app-BepXSDoE.js";import{B as x}from"./button-BZVkaX9H.js";import{I as u}from"./input-Ce2DZWVi.js";import{T as ae}from"./textarea-NbOgMCrS.js";import{C as P,a as I,b as L,c as M,d as R}from"./card-DaSB9O8q.js";import{L as h}from"./label-i2PKwYmJ.js";import{R as U,a as _}from"./radio-group-DMdUS8A6.js";import{C as $}from"./checkbox-8xAItRyd.js";import{T as V,a as B,b as w,c as G}from"./tabs-BjnWARxz.js";import{P as v}from"./plus-B1Q8t9AJ.js";import{S as le}from"./save-DSYnTje2.js";import{C as ne}from"./copy-BpK5bTQz.js";import{T as de}from"./trash-2--9bzI7Ec.js";function be({course_id:H,courseQuiz:t}){var F,S,q,A,O,D,E,J;const{data:a,setData:o,post:K,delete:W}=re({quizTitle:{en:t&&((F=JSON.parse(t.title))==null?void 0:F.en)||"",fr:t&&((S=JSON.parse(t.title))==null?void 0:S.fr)||"",ar:t&&((q=JSON.parse(t.title))==null?void 0:q.ar)||""},quizDescription:{en:t&&((A=JSON.parse(t.description))==null?void 0:A.en)||"",fr:t&&((O=JSON.parse(t.description))==null?void 0:O.fr)||"",ar:t&&((D=JSON.parse(t.description))==null?void 0:D.ar)||""},quizTime:(t==null?void 0:t.time)||"",quizPublish:(t==null?void 0:t.publish)||0,questions:(t==null?void 0:t.questions)||[],course_id:H}),j=s=>{var d,c;const r=((d=a.questions)==null?void 0:d.length)>0?Math.max(...(c=a.questions)==null?void 0:c.map(p=>p.id))+1:1;let i;switch(s){case"multiple-choice":i={id:r,type:"multiple-choice",text:{en:"",fr:"",ar:""},options:[{id:1,text:{en:"",fr:"",ar:""},isCorrect:!0},{id:2,text:{en:"",fr:"",ar:""},isCorrect:!1},{id:3,text:{en:"",fr:"",ar:""},isCorrect:!1},{id:4,text:{en:"",fr:"",ar:""},isCorrect:!1}],allow_multiple:!1};break;case"true-false":i={id:r,type:"true-false",text:{en:"",fr:"",ar:""},correct_answer:!0};break;case"short-answer":i={id:r,type:"short-answer",text:{en:"",fr:"",ar:""},correct_answer:{en:"",fr:"",ar:""}};break;default:i={id:r,type:"true-false",text:{en:"",fr:"",ar:""},correct_answer:!0}}const n=[...a.questions,i];o("questions",n)},X=s=>{var n;((n=t==null?void 0:t.questions)==null?void 0:n.some(d=>d.id===s))&&W(route("question.destroy",{question:s}));const i=a.questions.filter(d=>d.id!==s);o("questions",i)},Y=s=>{var c,p;const r=a.questions.find(l=>l.id===s);if(!r)return;const i=((c=a.questions)==null?void 0:c.length)>0?Math.max(...(p=a.questions)==null?void 0:p.map(l=>l.id))+1:1,n=JSON.parse(JSON.stringify(r));n.id=i;const d=[...questions,n];o("questions",d)},Z=(s,r,i)=>{o({...a,questions:a.questions.map(n=>n.id===s?{...n,text:{...n.text,[r]:i}}:n)})},g=(s,r,i)=>{o({...a,questions:a.questions.map(n=>{if(n.id===s&&n.type==="multiple-choice"){const d=n;return d.allow_multiple?{...d,options:d.options.map(c=>({...c,isCorrect:c.text[i]===r?!c.isCorrect:c.isCorrect}))}:{...d,options:d.options.map(c=>({...c,isCorrect:c.text[i]===r}))}}return n})})},k=(s,r,i,n)=>{o({...a,questions:a.questions.map(d=>d.id===s&&d.type==="multiple-choice"?{...d,options:d.options.map((c,p)=>p===r?{...c,text:{...typeof c.text=="object"&&c.text!==null?c.text:{},[i]:n}}:c)}:d)})},z=s=>{o({...a,questions:a.questions.map(r=>{if(r.id===s&&r.type==="multiple-choice"){const i=r;return{...i,allow_multiple:!i.allow_multiple}}return r})})},Q=(s,r)=>{o({...a,questions:a.questions.map(i=>i.id===s&&i.type==="true-false"?{...i,correct_answer:r}:i)})},ee=(s,r,i)=>{o({...a,questions:a.questions.map(n=>n.id===s&&n.type==="short-answer"?{...n,correct_answer:{...n.correct_answer,[r]:i}}:n)})},se=(s,r)=>e.jsxs(P,{className:"mb-6",children:[e.jsxs(I,{className:"flex flex-row items-start justify-between space-y-0 pb-2",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-base flex items-center gap-2",children:["Question ",r+1]}),e.jsx(M,{children:te(s.type)})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(x,{variant:"ghost",size:"icon",onClick:()=>Y(s.id),className:"h-8 w-8",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Duplicate"})]}),e.jsxs(x,{variant:"ghost",size:"icon",onClick:()=>X(s.id),className:"text-destructive h-8 w-8",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Remove question"})]})]})]}),e.jsx(R,{className:"space-y-4 pt-0",children:e.jsxs(V,{defaultValue:"en",children:[e.jsxs(B,{className:"grid w-full grid-cols-3",children:[e.jsx(w,{value:"en",children:"English"}),e.jsx(w,{value:"fr",children:"French"}),e.jsx(w,{value:"ar",children:"Arabic"})]}),["en","fr","ar"].map(i=>{var n,d,c,p;return e.jsxs(G,{value:i,children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:`question-${s.id}`,children:"Question"}),e.jsx(ae,{id:`question-${s.id}`,value:s.text[i],onChange:l=>Z(s.id,i,l.target.value),placeholder:"Enter your question",disabled:(n=t==null?void 0:t.questions)==null?void 0:n.some(l=>l.id===s.id),required:!0})]})})}),s.type==="multiple-choice"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Answer Options"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{id:`allow-multiple-${s.id}`,checked:s.allow_multiple,onCheckedChange:()=>z(s.id),disabled:(d=t==null?void 0:t.questions)==null?void 0:d.some(l=>l.id===s.id)}),e.jsx(h,{htmlFor:`allow-multiple-${s.id}`,className:"text-sm",children:"Allow multiple correct answers"})]})]}),s.allow_multiple?e.jsx("div",{className:"space-y-2",children:s.options.map((l,f)=>{var N,C,b;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{id:`q${s.id}-option-${f}`,checked:l.isCorrect,onCheckedChange:()=>g(s.id,l.text[i],i),disabled:((N=t==null?void 0:t.questions)==null?void 0:N.some(m=>m.id===s.id))||!((C=a.questions.find(m=>m.id===s.id))!=null&&C.options.every(m=>{var y,T;return(T=(y=m.text)==null?void 0:y[i])==null?void 0:T.trim()}))}),e.jsx(u,{value:l.text[i],onChange:m=>k(s.id,f,i,m.target.value),placeholder:`Option ${l.text[i]}`,className:"flex-1",disabled:(b=t==null?void 0:t.questions)==null?void 0:b.some(m=>m.id===s.id),required:!0})]},f)})}):e.jsx(U,{children:s.options.map((l,f)=>{var N,C,b;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{value:l.text[i],id:`q${s.id}-option-${l.text[i]}`,checked:l.isCorrect,onClick:()=>g(s.id,l.text[i],i),disabled:((N=t==null?void 0:t.questions)==null?void 0:N.some(m=>m.id===s.id))||!((C=a.questions.find(m=>m.id===s.id))!=null&&C.options.every(m=>{var y,T;return(T=(y=m.text)==null?void 0:y[i])==null?void 0:T.trim()}))}),e.jsx(u,{value:l.text[i],onChange:m=>k(s.id,f,i,m.target.value),placeholder:`Option ${l.text[i]}`,className:"flex-1",disabled:(b=t==null?void 0:t.questions)==null?void 0:b.some(m=>m.id===s.id),required:!0})]},f)})})]}),s.type==="true-false"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Correct Answer"}),e.jsxs(U,{value:s.correct_answer=="1"?"true":"false",onValueChange:l=>Q(s.id,l=="true"),className:"flex space-x-4",disabled:(c=t==null?void 0:t.questions)==null?void 0:c.some(l=>l.id===s.id),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{value:"true",id:`q${s.id}-true`}),e.jsx(h,{htmlFor:`q${s.id}-true`,children:"True"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{value:"false",id:`q${s.id}-false`}),e.jsx(h,{htmlFor:`q${s.id}-false`,children:"False"})]})]})]}),s.type==="short-answer"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:`answer-${s.id}`,children:"Correct Answer"}),e.jsx(u,{id:`answer-${s.id}`,value:s.correct_answer[i],onChange:l=>ee(s.id,i,l.target.value),placeholder:"Enter the correct answer",disabled:(p=t==null?void 0:t.questions)==null?void 0:p.some(l=>l.id===s.id),required:!0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Students must enter this exact answer to be marked correct."})]})]},i)})]})})]},s.id),te=s=>{switch(s){case"multiple-choice":return"Multiple choice question";case"true-false":return"True/False question";case"short-answer":return"Short answer question";default:return"Question"}},ie=()=>{K(route("quiz.store"),{onFinish:()=>{o({title:"",description:"",timelimit:"",published:0,chapter_id:1,questions:[]})}})};return e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center mb-6 gap-3",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Create Quiz"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(P,{children:[e.jsxs(I,{children:[e.jsx(L,{children:"Quiz Information"}),e.jsx(M,{children:"Enter the basic information about your quiz"})]}),e.jsxs(R,{className:"space-y-4",children:[e.jsxs(V,{defaultValue:"en",children:[e.jsxs(B,{className:"grid w-full grid-cols-3",children:[e.jsx(w,{value:"en",children:"English"}),e.jsx(w,{value:"fr",children:"French"}),e.jsx(w,{value:"ar",children:"Arabic"})]}),["en","fr","ar"].map(s=>e.jsx(G,{value:s,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(h,{htmlFor:`title-${s}`,children:["Title (",s.toUpperCase(),")"]}),e.jsx(u,{id:`title-${s}`,placeholder:`Title (${s.toUpperCase()})`,value:a.quizTitle[`${s}`],onChange:r=>o("quizTitle",{...a.quizTitle,[`${s}`]:r.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(h,{htmlFor:`description-${s}`,children:["Description (",s.toUpperCase(),")"]}),e.jsx(u,{id:`description-${s}`,placeholder:`Description (${s.toUpperCase()})`,value:a.quizDescription[`${s}`],onChange:r=>o("quizDescription",{...a.quizDescription,[`${s}`]:r.target.value})})]})]})},s))]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"quizTime",children:"Time Limit (minutes)"}),e.jsx(u,{id:"quizTime",type:"number",min:"1",value:a.quizTime,onChange:s=>o("quizTime",s.target.value),placeholder:"Enter time limit"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{id:"quizPublish",checked:a.quizPublish,onCheckedChange:s=>o("quizPublish",s)}),e.jsx(h,{htmlFor:"publish",children:"Publish immediately"})]})]})]}),e.jsxs("form",{onSubmit:ie,children:[((E=a.questions)==null?void 0:E.length)===0?e.jsxs("div",{className:"text-center py-12 border rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Questions Added"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Add your first question to get started"}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[e.jsxs(x,{type:"button",onClick:()=>j("multiple-choice"),children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Multiple Choice"]}),e.jsxs(x,{type:"button",onClick:()=>j("true-false"),children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"True/False"]}),e.jsxs(x,{type:"button",onClick:()=>j("short-answer"),children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Short Answer"]})]})]}):e.jsxs(e.Fragment,{children:[(J=a.questions)==null?void 0:J.map((s,r)=>se(s,r)),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-6",children:[e.jsxs(x,{type:"button",onClick:()=>j("multiple-choice"),children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Add Multiple Choice"]}),e.jsxs(x,{type:"button",onClick:()=>j("true-false"),children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Add True/False"]}),e.jsxs(x,{type:"button",onClick:()=>j("short-answer"),children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Add Short Answer"]})]})]}),e.jsx("div",{className:"flex justify-end gap-2 mt-8",children:e.jsxs(x,{type:"submit",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Save Quiz"]})})]})]})]})}export{be as C};
