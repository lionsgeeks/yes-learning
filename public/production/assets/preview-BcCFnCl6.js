import{K as X,r as f,j as e,L as Y,$ as Z,S as b}from"./app-D4TMrZXc.js";import{B as V}from"./badge-jWZ_So_A.js";import{B as p}from"./button-CbAxOMBv.js";import{C as O,a as k,b as ee,d as Q}from"./card-BUZKdygx.js";import{A as se,D as te,a as ae,b as re,c as ne}from"./app-layout-CFiiGJaS.js";import{S as ie}from"./scroll-area-Yl23ltWn.js";import{T as le,a as de,b as ce,c as me}from"./tabs-4J5HzUdS.js";import{B as oe,L as xe,P as he,C as pe,a as ue,b as je,c as fe,p as ge,d as Ne,e as ve,A as ye,f as we,g as Ce}from"./index-CkAJ5eUW.js";import{C as R}from"./chevron-left-CkcVu-7l.js";import{B as Se}from"./book-open-CutzJHx1.js";import{C as De}from"./chevron-down-B-nyD14p.js";import{C as Be}from"./circle-check-big-DnDyGrpX.js";import{F as Le}from"./file-text-GeR8BLD1.js";import{D as Pe}from"./download-CRAqONwq.js";import{C as H}from"./index-DZBFr4dZ.js";import"./index-D0Y7t9tT.js";import"./index-C_QyVRLl.js";import"./index-CvL4AiEa.js";import"./index-BdQq_4o_.js";pe.register(ue,je,fe,ge,Ne,ve,ye,we,Ce);const Ye=()=>{var w,C;const{course:u,chapters:d,auth:N}=X().props,[K,v]=f.useState((w=d[0])==null?void 0:w.id),[n,M]=f.useState("en"),[i,g]=f.useState(1),[$e,W]=f.useState(0),y=t=>{W(t/d.length*100)},q=[{title:u.name[n],href:`/course/${u.id}`}],G=()=>{g(i+1),y(i),v(K+1)};function J(t){var j,o,s;const a=t.content,l={labels:a.data.map(x=>x.name),datasets:[{label:"Dataset",data:a.data.map(x=>x.value),backgroundColor:(a==null?void 0:a.type)==="pie"?"rgba(75, 192, 192, 0.2)":"rgba(255, 99, 132, 0.2)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1}]},c={responsive:!0,plugins:{title:{display:!0,text:(a==null?void 0:a.title)||"Chart Preview"}}};return e.jsx("div",{className:"bg- rounded-md",children:e.jsx("div",{className:"h-full w-full",children:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"",children:[((j=t.content)==null?void 0:j.type)==="bar"&&e.jsx(oe,{data:l,options:c}),((o=t.content)==null?void 0:o.type)==="line"&&e.jsx(xe,{data:l,options:c}),((s=t.content)==null?void 0:s.type)==="pie"&&e.jsx(he,{data:l,options:c})]})})})})}function U(t){const a=/(?:https?:\/\/(?:www\.)?youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=))([^"&?/]+)/,l=t.match(a);return l&&l[1]}return e.jsxs(se,{breadcrumbs:q,children:[e.jsx(Y,{title:u.name[n]}),e.jsxs("div",{dir:n==="ar"?"rtl":"ltr",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs(Z,{href:"/admin/courses",className:"text-muted-foreground hover:text-foreground inline-flex items-center text-sm transition-colors",children:[e.jsx(R,{className:"mr- h-4 w-4"}),"Back to Courses"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center justify-between gap-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:u.name[n]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(V,{variant:"outline",className:"px-2 py-0 text-xs font-normal",children:[e.jsx(Se,{className:"mr-1 h-3 w-3"}),d.length," lessons"]})})]})]}),e.jsx("div",{className:"p-4",children:e.jsxs(te,{className:"",children:[e.jsx(ae,{asChild:!0,children:e.jsxs(p,{variant:"ghost",size:"sm",className:"h-8",children:[n==="en"?"English":n==="ar"?"العربية ":"Français"," ",e.jsx(De,{className:"ml-1 h-4 w-4"})]})}),e.jsx(re,{align:"end",children:["en","ar","fr"].map(t=>e.jsx(ne,{onClick:()=>M(t),children:e.jsx("span",{className:"mr-2",children:t})},t))})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 p-6 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(O,{children:[e.jsx(k,{className:"py-",children:e.jsx(ee,{className:"text-lg",children:"Course Content"})}),e.jsx(Q,{className:"p-0",children:e.jsx(ie,{className:"h-[calc(100vh-300px)]",children:e.jsx("div",{className:"space-y-1 p-2",children:d.map((t,a)=>e.jsx("div",{onClick:()=>{g(a+1),y(a+1),v(t.id)},className:`flex cursor-pointer items-center justify-between rounded-md px-2 py-1.5 text-sm transition-colors ${a+1===i?"bg-primary/80 text-primary-foreground":"hover:bg-muted"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.hasQuiz&&e.jsx(V,{variant:"outline",className:"h-5 px-1 text-[10px]",children:"Quiz"}),e.jsx("span",{className:a+1===i?"":"text-muted-foreground text-xs",children:t.estimated_duration[n]}),e.jsx("span",{className:a+1===i?"":"text-muted-foreground",children:t==null?void 0:t.title[n]})]})},a))})})})]})}),e.jsxs("div",{dir:N.user.language==="ar"?"rtl":"ltr",className:"lg:col-span-9",children:[e.jsx(O,{className:"overflow-hidden",children:e.jsx(Q,{className:"",children:e.jsxs(le,{defaultValue:"content",children:[e.jsx(de,{className:"mb-4",children:e.jsx(ce,{value:"content",children:" Lesson Content"})}),e.jsxs(me,{value:"content",className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-xl font-medium",children:(C=d[0])==null?void 0:C.title[n]})}),e.jsx("div",{dir:N.user.language==="ar"?"rtl":"ltr",className:"prose max-w-none",children:d.flatMap((t,a)=>{var l;return(l=t==null?void 0:t.content[n])==null?void 0:l.flatMap((c,j)=>{var o;return(o=c==null?void 0:c.blocks)==null?void 0:o.map((s,x)=>{var S,D,B,L,P,$,T,A,_,E,F;return a+1===i&&e.jsxs("div",{className:"rounded-md p-4",children:[((S=s.content)==null?void 0:S.title)&&e.jsx("h3",{className:"mb-2 font-medium",children:(D=s.content)==null?void 0:D.title}),(s==null?void 0:s.type)==="text"&&s.content.body&&e.jsx("div",{className:"prose max-w-none",children:e.jsx("p",{children:s.content.body})}),(s==null?void 0:s.type)==="image"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted flex aspect-video items-center justify-center rounded-md",children:e.jsx("img",{src:`/storage/${s.content.url}`,alt:"Course cover preview",className:"h-auto w-full rounded-md object-cover"})}),s.content.caption&&e.jsx("p",{className:"text-muted-foreground text-center text-sm",children:s.content.caption})]}),(s==null?void 0:s.type)==="video"&&s.content.url&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted flex aspect-video items-center justify-center rounded-md",children:e.jsx("iframe",{width:"866",height:"487",src:`https://www.youtube.com/embed/${U(s.content.url)}`,title:"Video",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0})}),s.content.caption&&e.jsx("p",{className:"text-muted-foreground text-center text-sm",children:s.content.caption})]}),(s==null?void 0:s.type)==="list"&&e.jsx("div",{children:((B=s.content)==null?void 0:B.type)==="bullet"?e.jsx("ul",{className:"list-disc space-y-1 pl-5",children:(L=s.content.items||["Sample item"])==null?void 0:L.map((m,r)=>e.jsx("li",{children:m},r))}):((P=s.content)==null?void 0:P.type)==="numbered"?e.jsx("ol",{className:"list-decimal space-y-1 pl-5",children:($=s.content.items||["Sample item"])==null?void 0:$.map((m,r)=>e.jsx("li",{children:m},r))}):e.jsx("div",{className:"space-y-2",children:(A=((T=s.content)==null?void 0:T.items)||["Sample item"])==null?void 0:A.map((m,r)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"text-primary mr-2 h-4 w-4"}),e.jsx("span",{children:m})]},r))})}),(s==null?void 0:s.type)==="table"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-muted",children:(_=Array.from({length:s.content.cols||3}))==null?void 0:_.map((m,r)=>{var h;return e.jsx("th",{className:"border p-2 text-left",children:(h=s.content)==null?void 0:h.data[0][r]},r)})})}),e.jsx("tbody",{children:(E=Array.from({length:s.content.rows-1||3}))==null?void 0:E.map((m,r)=>{var h;return e.jsx("tr",{children:(h=Array.from({length:s.content.cols||3}))==null?void 0:h.map((Te,z)=>{var I;return e.jsx("td",{className:"border p-2",children:(I=s.content)==null?void 0:I.data[r+1][z]},z)})},r)})})]})}),(s==null?void 0:s.type)==="chart"&&J(s),(s==null?void 0:s.type)==="document"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs("div",{className:"bg-muted/30 flex items-center justify-between border-b p-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"text-primary mr-2 h-5 w-5"}),e.jsx("div",{className:"font-medium",children:e.jsx("span",{children:((F=s.content)==null?void 0:F.title)||"PDF Document"})})]}),e.jsx("a",{href:`/storage/${s.content.url}`,target:"_blank",download:!0,children:e.jsxs(p,{variant:"outline",size:"sm",className:"h-8",children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"Download"]})})]})}),s.content.description&&e.jsx("p",{className:"text-muted-foreground text-sm",children:s.content.description})]})]},`${a}-${j}-${x}`)})})})})]})]})})}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[i>1&&e.jsxs(p,{variant:"outline",onClick:()=>g(i-1),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Previous Lesson"]}),i===d.length?e.jsxs(p,{onClick:()=>b.visit("/admin/courses"),children:["Back to courses",e.jsx(H,{className:"ml-2 h-4 w-4"})]}):e.jsxs(p,{onClick:()=>{G()},children:["Next",e.jsx(H,{className:"ml-2 h-4 w-4"})]})]})]})]})]})]})};export{Ye as default};
