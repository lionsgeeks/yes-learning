import{r as d,j as e,m as X,L as Y,$ as ee}from"./app-Dd7Q8jNu.js";import{c as te,u as L,S as oe,a as se,B as y}from"./button-KjDgFd1P.js";import{C as S,a as A,b as O,c as F,d as E,e as re}from"./card-CfFIHGbB.js";import{C as ne}from"./checkbox-0UmBl_T2.js";import{I as T}from"./input-CKZp8rp8.js";import{L as v}from"./label-MZ4qcrcX.js";import{d as ae,c as ce,P as $,a as P}from"./index-Clufub-a.js";import{c as V,R as le,u as ie,P as de,h as pe,a as ue,b as he,F as me,D as fe,d as xe,A as H,e as ve}from"./index-jda3ngqe.js";import{P as z}from"./index-CJnyyRVE.js";import{S as k,a as D,b as I,c as M,d as C}from"./select-BVCvdu5o.js";import{T as ge,c as je}from"./tabs-CsNbqTkm.js";import{T as Ce}from"./textarea-DIpC6JMV.js";import{A as Pe,T as Ne}from"./app-layout-BA-I2_TL.js";import{F as we}from"./file-text-CH7zLvRt.js";import"./index-DiPPBe7i.js";import"./check-BoPQFPlN.js";import"./index-BdQq_4o_.js";import"./chevron-down-BhKfBWad.js";import"./book-open-5AuiOLw1.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],be=te("Send",ye);var b="Popover",[G,at]=ce(b,[V]),N=V(),[Re,m]=G(b),B=t=>{const{__scopePopover:i,children:c,open:s,defaultOpen:r,onOpenChange:n,modal:o=!1}=t,l=N(i),u=d.useRef(null),[p,f]=d.useState(!1),[x=!1,h]=ae({prop:s,defaultProp:r,onChange:n});return e.jsx(le,{...l,children:e.jsx(Re,{scope:i,contentId:ie(),triggerRef:u,open:x,onOpenChange:h,onOpenToggle:d.useCallback(()=>h(j=>!j),[h]),hasCustomAnchor:p,onCustomAnchorAdd:d.useCallback(()=>f(!0),[]),onCustomAnchorRemove:d.useCallback(()=>f(!1),[]),modal:o,children:c})})};B.displayName=b;var K="PopoverAnchor",_e=d.forwardRef((t,i)=>{const{__scopePopover:c,...s}=t,r=m(K,c),n=N(c),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=r;return d.useEffect(()=>(o(),()=>l()),[o,l]),e.jsx(H,{...n,...s,ref:i})});_e.displayName=K;var U="PopoverTrigger",Se=d.forwardRef((t,i)=>{const{__scopePopover:c,...s}=t,r=m(U,c),n=N(c),o=L(i,r.triggerRef),l=e.jsx(z.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":Q(r.open),...s,ref:o,onClick:P(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?l:e.jsx(H,{asChild:!0,...n,children:l})});Se.displayName=U;var R="PopoverPortal",[Ae,Oe]=G(R,{forceMount:void 0}),W=t=>{const{__scopePopover:i,forceMount:c,children:s,container:r}=t,n=m(R,i);return e.jsx(Ae,{scope:i,forceMount:c,children:e.jsx($,{present:c||n.open,children:e.jsx(de,{asChild:!0,container:r,children:s})})})};W.displayName=R;var g="PopoverContent",Z=d.forwardRef((t,i)=>{const c=Oe(g,t.__scopePopover),{forceMount:s=c.forceMount,...r}=t,n=m(g,t.__scopePopover);return e.jsx($,{present:s||n.open,children:n.modal?e.jsx(Fe,{...r,ref:i}):e.jsx(Ee,{...r,ref:i})})});Z.displayName=g;var Fe=d.forwardRef((t,i)=>{const c=m(g,t.__scopePopover),s=d.useRef(null),r=L(i,s),n=d.useRef(!1);return d.useEffect(()=>{const o=s.current;if(o)return pe(o)},[]),e.jsx(ue,{as:oe,allowPinchZoom:!0,children:e.jsx(q,{...t,ref:r,trapFocus:c.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:P(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),n.current||(l=c.triggerRef.current)==null||l.focus()}),onPointerDownOutside:P(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,p=l.button===2||u;n.current=p},{checkForDefaultPrevented:!1}),onFocusOutside:P(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ee=d.forwardRef((t,i)=>{const c=m(g,t.__scopePopover),s=d.useRef(!1),r=d.useRef(!1);return e.jsx(q,{...t,ref:i,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:n=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,n),n.defaultPrevented||(s.current||(l=c.triggerRef.current)==null||l.focus(),n.preventDefault()),s.current=!1,r.current=!1},onInteractOutside:n=>{var u,p;(u=t.onInteractOutside)==null||u.call(t,n),n.defaultPrevented||(s.current=!0,n.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=n.target;((p=c.triggerRef.current)==null?void 0:p.contains(o))&&n.preventDefault(),n.detail.originalEvent.type==="focusin"&&r.current&&n.preventDefault()}})}),q=d.forwardRef((t,i)=>{const{__scopePopover:c,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:n,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:p,onInteractOutside:f,...x}=t,h=m(g,c),j=N(c);return he(),e.jsx(me,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:n,children:e.jsx(fe,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:p,onDismiss:()=>h.onOpenChange(!1),children:e.jsx(xe,{"data-state":Q(h.open),role:"dialog",id:h.contentId,...j,...x,ref:i,style:{...x.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),J="PopoverClose",Te=d.forwardRef((t,i)=>{const{__scopePopover:c,...s}=t,r=m(J,c);return e.jsx(z.button,{type:"button",...s,ref:i,onClick:P(t.onClick,()=>r.onOpenChange(!1))})});Te.displayName=J;var ke="PopoverArrow",De=d.forwardRef((t,i)=>{const{__scopePopover:c,...s}=t,r=N(c);return e.jsx(ve,{...r,...s,ref:i})});De.displayName=ke;function Q(t){return t?"open":"closed"}var Ie=B,Me=W,Le=Z;function $e({...t}){return e.jsx(Ie,{"data-slot":"popover",...t})}function Ve({className:t,align:i="center",sideOffset:c=4,...s}){return e.jsx(Me,{children:e.jsx(Le,{"data-slot":"popover-content",align:i,sideOffset:c,className:se("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...s})})}const ct=({courses:t})=>{const[i,c]=d.useState(!1),[s,r]=d.useState("en"),n=[{title:"Newsletter",href:"/admin/newsletter"}],{data:o,setData:l,post:u,errors:p}=X({subject:{en:"",fr:"",ar:""},content:{en:"",fr:"",ar:""},template:"blank",recipient_type:"all",courses:[],schedule_date:""}),f=()=>t.filter(a=>o.courses.includes(a.id)),x=()=>{const a={...o,courses:o.recipient_type==="courses"?f():[]};u("/admin/newsletter/send",{data:a})},h=()=>{const a={...o,courses:o.recipient_type==="courses"?f():[]};u("/admin/newsletter/schedule",{data:a})},j=a=>{o.courses.includes(a)?l("courses",o.courses.filter(w=>w!==a)):l("courses",[...o.courses,a])},_=(a,w)=>{l({...o,[a]:{...o[a],[s]:w}})};return e.jsxs(Pe,{breadcrumbs:n,children:[e.jsx(Y,{title:"Newsletter"}),e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Newsletter"}),e.jsx("p",{className:"text-muted-foreground",children:"Create and send newsletters to your students"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ee,{href:route("newsletter.history"),children:e.jsxs(y,{variant:"outline",children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"View History"]})})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(v,{htmlFor:"language",children:"Language"}),e.jsxs(k,{value:s,onValueChange:r,children:[e.jsx(D,{className:"w-[180px]",children:e.jsx(I,{placeholder:"Select a language"})}),e.jsxs(M,{children:[e.jsx(C,{value:"en",children:"English"}),e.jsx(C,{value:"fr",children:"French"}),e.jsx(C,{value:"ar",children:"Arabic"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(ge,{defaultValue:"compose",className:"w-full",children:e.jsx(je,{value:"compose",className:"space-y-4",children:e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsx(O,{children:"Compose Newsletter"}),e.jsx(F,{children:"Create a new newsletter to send to your students"})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{htmlFor:"subject",children:["Subject (",s,")"]}),e.jsx(T,{id:"subject",placeholder:"Enter newsletter subject",value:o.subject[s],onChange:a=>_("subject",a.target.value)}),p.subject&&e.jsx("p",{className:"text-sm text-red-500",children:p.subject})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{htmlFor:"content",children:["Content (",s,")"]}),e.jsx(Ce,{id:"content",placeholder:"Write your newsletter content here...",className:"min-h-[200px]",value:o.content[s],onChange:a=>_("content",a.target.value)}),p.content&&e.jsx("p",{className:"text-sm text-red-500",children:p.content})]})]}),e.jsx(re,{className:"flex justify-end",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx($e,{children:e.jsx(Ve,{className:"w-auto p-4",align:"end",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{type:"datetime-local",value:o.schedule_date,onChange:a=>l("schedule_date",a.target.value)}),e.jsx(y,{onClick:h,children:"Schedule Send"})]})})}),e.jsxs(y,{onClick:x,children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),"Send"]})]})})]})})})}),e.jsx("div",{className:"space-y-4",children:e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsx(O,{children:"Recipients"}),e.jsx(F,{children:"Choose who will receive this newsletter."})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"recipient_type",children:"Send To"}),e.jsxs(k,{value:o.recipient_type,onValueChange:a=>l("recipient_type",a),children:[e.jsx(D,{className:"w-full",children:e.jsx(I,{placeholder:"Select recipient type"})}),e.jsxs(M,{children:[e.jsx(C,{value:"all",children:"All Users"}),e.jsx(C,{value:"courses",children:"Courses"})]})]})]}),o.recipient_type==="courses"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Select Courses"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:t.map(a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{id:`course-${a.id}`,checked:o.courses.includes(a),onCheckedChange:()=>j(a)}),e.jsx(v,{htmlFor:`course-${a.id}`,children:e.jsx(Ne,{en:a.name.en,fr:a.name.fr,ar:a.name.ar})})]},a.id))})]})]})]})})]})]})]})};export{ct as default};
