import{K as O,m as $,r as C,j as e,L,$ as c,S as v}from"./app-C63RW_A8.js";import{A as B,D as K,a as z,b as F,c as g}from"./app-layout-C86-vYy4.js";import{u as G,a as A,D as H,c as Q,S as R,v as U,s as _,K as q,P as V,b as W,C as J}from"./sortable.esm-BqG2bcdx.js";import{E as X}from"./edit-course-modal-bOuLiY-t.js";import{B as i}from"./button-C9oGkuB1.js";import{A as Y}from"./admin-users-table-JJ9coXo3.js";import{C as Z}from"./createQuiz-D9y37uF0.js";import{C as ee,a as se,d as re}from"./card-D5-mwLWY.js";import{E as te,A as ie,a as oe,b as ae,c as ne,d as le,e as de,f as ce,g as me}from"./alert-dialog-DU3BoMIj.js";import{T as he}from"./TruncateText-D9Sejyoj.js";import{A as pe}from"./arrow-left-zkU-0xLB.js";import{S as y}from"./square-pen-O9gGr2H6.js";import{P as S}from"./plus-BR9vaOBG.js";import{E}from"./eye-DuRPuoDG.js";import{T as ue}from"./trash-2-DKOJ9GyN.js";import"./sidebar-DVSB-QeP.js";import"./index-BnriUOpo.js";import"./index-C2UCfdsy.js";import"./index-DG3HcBNq.js";import"./book-open-CZEBvkvN.js";import"./dialog-BvJSafTo.js";import"./input-xWbc2EED.js";import"./label-BFMajRWC.js";import"./tabs-oE-yzVpY.js";import"./textarea-DREkHze9.js";import"./image-DtSp-YCz.js";import"./table-DgaGv9ni.js";import"./badge-D73r7Sqn.js";import"./select-BKmNIRiG.js";import"./index-BdQq_4o_.js";import"./chevron-down-jG5fkIAI.js";import"./check-T1rm7eTg.js";import"./search-BKyGJwfN.js";import"./filter-DE4e80cM.js";import"./radio-group-CCZvIIS1.js";import"./checkbox-fzd1Cfmq.js";import"./save-B0f3D73a.js";import"./copy-BEcaG9Al.js";function xe({chapter:r,onTogglePublish:w,onEdit:b,idx:m,onDelete:h}){const{attributes:N,listeners:o,setNodeRef:a,transform:p,transition:l}=W({id:r.id}),u={transform:J.Transform.toString(p),transition:l},[x,d]=C.useState(!1);return e.jsxs("div",{ref:a,style:u,className:"flex items-center border-b p-4 last:border-b-0",children:[e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-primary/10 text-primary mr-3 flex h-8 w-8 items-center justify-center rounded-full",children:m+1}),e.jsxs("div",{children:[e.jsx("h3",{className:"truncate font-medium",children:r.title.en}),e.jsx("p",{className:"text-muted-foreground truncate text-sm",children:e.jsx(he,{text:r.description.en,length:40})})]})]})}),e.jsx("div",{className:"ml-4 flex items-center gap-4",children:e.jsxs(K,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(i,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(F,{align:"end",children:[e.jsxs(g,{onClick:()=>v.visit(`/admin/courses/${course.id}`),children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"View"]}),e.jsxs(g,{onClick:()=>v.visit(`/admin/chapter/${r.id}/edit`),children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(g,{className:"text-destructive focus:text-destructive",onClick:()=>d(!0),children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}),e.jsx(ie,{open:x,onOpenChange:d,children:e.jsxs(oe,{children:[e.jsxs(ae,{children:[e.jsx(ne,{children:"Are you sure you want to delete this chapter?"}),e.jsx(le,{children:"This action cannot be undone. This will permanently delete the chapter and all its content."})]}),e.jsxs(de,{children:[e.jsx(ce,{children:"Cancel"}),e.jsx(me,{onClick:()=>h(r.id),className:"bg-destructive text-white hover:bg-destructive/90",children:"Delete"})]})]})})]})}const es=()=>{const{course:r,modules:w,courseQuiz:b}=O().props,{delete:m}=$(),h=s=>{m(route("chapter.destroy",s),{onFinish:()=>a(o.filter(t=>t.id!==s))})},N=[{title:"course - "+r.name.en}],[o,a]=C.useState(w),[p,l]=C.useState(!1),u=G(A(V),A(q,{coordinateGetter:_})),x=s=>{a(o.map(t=>t.id===s?{...t,published:!t.published}:t))},d=s=>{const{active:t,over:D}=s;t.id!==D.id&&a(j=>{const P=j.findIndex(n=>n.id===t.id),k=j.findIndex(n=>n.id===D.id),f=[...j],[M]=f.splice(P,1);return f.splice(k,0,M),f.map((n,I)=>({...n,position:I+1}))})},T=s=>{v.push(`/dashboard/courses/jhg/chapters/${s.id}`)};return e.jsxs(B,{breadcrumbs:N,children:[e.jsx(L,{title:"Courses"}),e.jsxs("div",{className:"space-y-6 p-3 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:"outline",asChild:!0,children:e.jsxs(c,{href:"/admin/courses",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs(i,{variant:"outline",onClick:()=>l(!0),children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Edit Course"]}),e.jsx(i,{variant:"outline",asChild:!0,children:e.jsxs(c,{href:"/dashboard/courses/jhg/workshops/new",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Create Workshop"]})}),e.jsx(i,{variant:"outline",asChild:!0,children:e.jsxs(c,{href:`preview/${r.id}`,target:"_blank",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Preview"]})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(ee,{className:"h-[70vh] overflow-y-auto",children:[e.jsx(se,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Course Chapters"}),e.jsx(i,{asChild:!0,children:e.jsxs(c,{href:"/admin/chapter/create?course="+r.id,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Add Chapter"]})})]})}),e.jsx(re,{className:"p-0",children:e.jsx(H,{sensors:u,collisionDetection:Q,onDragEnd:d,children:e.jsx(R,{items:o.map(s=>s.id),strategy:U,children:o.map((s,t)=>e.jsx("div",{children:e.jsx(xe,{chapter:s,onTogglePublish:x,onEdit:T,idx:t,onDelete:h},s.id)},t))})})})]}),e.jsx(Y,{role:!0,showAddButton:!1,title:"Enrolled users",description:"Manage NGOs enrolled in this course",Users:r.users})]}),e.jsx("div",{className:"",children:e.jsx(Z,{course_id:r.id,courseQuiz:b})})]}),e.jsx(X,{course:r,open:p,onOpenChange:l})]})};export{es as default};
